CKEDITOR.dialog.add("specialchar",function(j){var m,c=j.lang.specialchar,i,g,b,r,o,a;g=function(e){var d;e=e.data?e.data.getTarget():new CKEDITOR.dom.element(e);"a"==e.getName()&&(d=e.getChild(0).getHtml())&&(e.removeClass("cke_light_background"),m.hide(),e=j.document.createElement("span"),e.setHtml(d),j.insertText(e.getText()))};b=CKEDITOR.tools.addFunction(g);o=function(k,d){var f;d=d||k.data.getTarget();"span"==d.getName()&&(d=d.getParent());if("a"==d.getName()&&(f=d.getChild(0).getHtml())){i&&r(null,i);var h=m.getContentElement("info","htmlPreview").getElement();m.getContentElement("info","charPreview").getElement().setHtml(f);h.setHtml(CKEDITOR.tools.htmlEncode(f));d.getParent().addClass("cke_light_background");i=d}};r=function(e,d){d=d||e.data.getTarget();"span"==d.getName()&&(d=d.getParent());"a"==d.getName()&&(m.getContentElement("info","charPreview").getElement().setHtml("\x26nbsp;"),m.getContentElement("info","htmlPreview").getElement().setHtml("\x26nbsp;"),d.getParent().removeClass("cke_light_background"),i=void 0)};a=CKEDITOR.tools.addFunction(function(h){h=new CKEDITOR.dom.event(h);var d=h.getTarget(),e;e=h.getKeystroke();var f="rtl"==j.lang.dir;switch(e){case 38:if(e=d.getParent().getParent().getPrevious()){e=e.getChild([d.getParent().getIndex(),0]),e.focus(),r(null,d),o(null,e)}h.preventDefault();break;case 40:(e=d.getParent().getParent().getNext())&&(e=e.getChild([d.getParent().getIndex(),0]))&&1==e.type&&(e.focus(),r(null,d),o(null,e));h.preventDefault();break;case 32:g({data:h});h.preventDefault();break;case f?37:39:if(e=d.getParent().getNext()){e=e.getChild(0),1==e.type?(e.focus(),r(null,d),o(null,e),h.preventDefault(!0)):r(null,d)}else{if(e=d.getParent().getParent().getNext()){(e=e.getChild([0,0]))&&1==e.type?(e.focus(),r(null,d),o(null,e),h.preventDefault(!0)):r(null,d)}}break;case f?39:37:(e=d.getParent().getPrevious())?(e=e.getChild(0),e.focus(),r(null,d),o(null,e),h.preventDefault(!0)):(e=d.getParent().getParent().getPrevious())?(e=e.getLast().getChild(0),e.focus(),r(null,d),o(null,e),h.preventDefault(!0)):r(null,d)}});return{title:c.title,minWidth:430,minHeight:280,buttons:[CKEDITOR.dialog.cancelButton],charColumns:17,onLoad:function(){for(var v=this.definition.charColumns,w=j.config.specialChars,x=CKEDITOR.tools.getNextId()+"_specialchar_table_label",u=['\x3ctable role\x3d"listbox" aria-labelledby\x3d"'+x+'" style\x3d"width: 320px; height: 100%; border-collapse: separate;" align\x3d"center" cellspacing\x3d"2" cellpadding\x3d"2" border\x3d"0"\x3e'],t=0,s=w.length,q,h;t<s;){u.push('\x3ctr role\x3d"presentation"\x3e');for(var p=0;p<v;p++,t++){if(q=w[t]){q instanceof Array?(h=q[1],q=q[0]):(h=q.replace("\x26","").replace(";","").replace("#",""),h=c[h]||q);var n="cke_specialchar_label_"+t+"_"+CKEDITOR.tools.getNextNumber();u.push('\x3ctd class\x3d"cke_dark_background" style\x3d"cursor: default" role\x3d"presentation"\x3e\x3ca href\x3d"javascript: void(0);" role\x3d"option" aria-posinset\x3d"'+(t+1)+'"',' aria-setsize\x3d"'+s+'"',' aria-labelledby\x3d"'+n+'"',' class\x3d"cke_specialchar" title\x3d"',CKEDITOR.tools.htmlEncode(h),'" onkeydown\x3d"CKEDITOR.tools.callFunction( '+a+', event, this )" onclick\x3d"CKEDITOR.tools.callFunction('+b+', this); return false;" tabindex\x3d"-1"\x3e\x3cspan style\x3d"margin: 0 auto;cursor: inherit"\x3e'+q+'\x3c/span\x3e\x3cspan class\x3d"cke_voice_label" id\x3d"'+n+'"\x3e'+h+"\x3c/span\x3e\x3c/a\x3e\x3c/td\x3e")}}u.push("\x3c/tr\x3e")}u.push("\x3c/tbody\x3e\x3c/table\x3e",'\x3cspan id\x3d"'+x+'" class\x3d"cke_voice_label"\x3e'+c.options+"\x3c/span\x3e");this.getContentElement("info","charContainer").getElement().setHtml(u.join(""))},contents:[{id:"info",label:j.lang.common.generalTab,title:j.lang.common.generalTab,padding:0,align:"top",elements:[{type:"hbox",align:"top",widths:["320px","90px"],children:[{type:"html",id:"charContainer",html:"",onMouseover:o,onMouseout:r,focus:function(){var d=this.getElement().getElementsByTag("a").getItem(0);setTimeout(function(){d.focus();o(null,d)},0)},onShow:function(){var d=this.getElement().getChild([0,0,0,0,0]);setTimeout(function(){d.focus();o(null,d)},0)},onLoad:function(d){m=d.sender}},{type:"hbox",align:"top",widths:["100%"],children:[{type:"vbox",align:"top",children:[{type:"html",html:"\x3cdiv\x3e\x3c/div\x3e"},{type:"html",id:"charPreview",className:"cke_dark_background",style:"border:1px solid #eeeeee;font-size:28px;height:40px;width:70px;padding-top:9px;font-family:'Microsoft Sans Serif',Arial,Helvetica,Verdana;text-align:center;",html:"\x3cdiv\x3e\x26nbsp;\x3c/div\x3e"},{type:"html",id:"htmlPreview",className:"cke_dark_background",style:"border:1px solid #eeeeee;font-size:14px;height:20px;width:70px;padding-top:2px;font-family:'Microsoft Sans Serif',Arial,Helvetica,Verdana;text-align:center;",html:"\x3cdiv\x3e\x26nbsp;\x3c/div\x3e"}]}]}]}]}]}});