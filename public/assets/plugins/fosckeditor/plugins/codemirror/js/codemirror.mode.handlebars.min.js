!function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/mode/simple.js",["../../lib/codemirror"],a):a(CodeMirror)}(function(j){function p(d,a){if(!d.hasOwnProperty(a)){throw new Error("Undefined state "+a+" in simple mode")}}function f(d,a){if(!d){return/(?:)/}var i="";return d instanceof RegExp?(d.ignoreCase&&(i="i"),d=d.source):d=String(d),new RegExp((!1===a?"":"^")+"(?:"+d+")",i)}function b(d){if(!d){return null}if(d.apply){return d}if("string"==typeof d){return d.replace(/\./g," ")}for(var a=[],i=0;i<d.length;i++){a.push(d[i]&&d[i].replace(/\./g," "))}return a}function c(a,d){(a.next||a.push)&&p(d,a.next||a.push),this.regex=f(a.regex),this.token=b(a.token),this.data=a}function m(d,a){return function(t,e){if(e.pending){var l=e.pending.shift();return 0==e.pending.length&&(e.pending=null),t.pos+=l.text.length,l.token}if(e.local){if(e.local.end&&t.match(e.local.end)){var A=e.local.endToken||null;return e.local=e.localState=null,A}var w,A=e.local.mode.token(t,e.localState);return e.local.endScan&&(w=e.local.endScan.exec(t.current()))&&(t.pos=t.start+w.index),A}for(var y=d[e.state],C=0;C<y.length;C++){var z=y[C],B=(!z.data.sol||t.sol())&&t.match(z.regex);if(B){z.data.next?e.state=z.data.next:z.data.push?((e.stack||(e.stack=[])).push(e.state),e.state=z.data.push):z.data.pop&&e.stack&&e.stack.length&&(e.state=e.stack.pop()),z.data.mode&&g(a,e,z.data.mode,z.token),z.data.indent&&e.indent.push(t.indentation()+a.indentUnit),z.data.dedent&&e.indent.pop();var x=z.token;if(x&&x.apply&&(x=x(B)),B.length>2&&z.token&&"string"!=typeof z.token){e.pending=[];for(var v=2;v<B.length;v++){B[v]&&e.pending.push({text:B[v],token:z.token[v-1]})}return t.backUp(B[0].length-(B[1]?B[1].length:0)),x[0]}return x&&x.join?x[0]:x}}return t.next(),null}}function h(i,a){if(i===a){return !0}if(!i||"object"!=typeof i||!a||"object"!=typeof a){return !1}var l=0;for(var d in i){if(i.hasOwnProperty(d)){if(!a.hasOwnProperty(d)||!h(i[d],a[d])){return !1}l++}}for(var d in a){a.hasOwnProperty(d)&&l--}return 0==l}function g(n,v,x,i){var e;if(x.persistent){for(var w=v.persistentStates;w&&!e;w=w.next){(x.spec?h(x.spec,w.spec):x.mode==w.mode)&&(e=w)}}var u=e?e.mode:x.mode||j.getMode(n,x.spec),y=e?e.state:j.startState(u);x.persistent&&!e&&(v.persistentStates={mode:u,spec:x.spec,state:y,next:v.persistentStates}),v.localState=y,v.local={mode:u,end:x.end&&f(x.end),endScan:x.end&&!1!==x.forceEnd&&f(x.end,!1),endToken:i&&i.join?i[i.length-1]:i}}function k(d,a){for(var i=0;i<a.length;i++){if(a[i]===d){return !0}}}function q(a,d){return function(x,y,n){if(x.local&&x.local.mode.indent){return x.local.mode.indent(x.localState,y,n)}if(null==x.indent||x.local||d.dontIndentStates&&k(x.state,d.dontIndentStates)>-1){return j.Pass}var v=x.indent.length-1,e=a[x.state];j:for(;;){for(var w=0;w<e.length;w++){var z=e[w];if(z.data.dedent&&!1!==z.data.dedentIfLineStart){var t=z.regex.exec(y);if(t&&t[0]){v--,(z.next||z.push)&&(e=a[z.next||z.push]),y=y.slice(t[0].length);continue j}}}break}return v<0?0:x.indent[v]}}j.defineSimpleMode=function(a,d){j.defineMode(a,function(e){return j.simpleMode(e,d)})},j.simpleMode=function(o,a){p(a,"start");var v={},t=a.meta||{},z=!1;for(var A in a){if(A!=t&&a.hasOwnProperty(A)){for(var B=v[A]=[],y=a[A],s=0;s<y.length;s++){var e=y[s];B.push(new c(e,a)),(e.indent||e.dedent)&&(z=!0)}}}var x={startState:function(){return{state:"start",pending:null,local:null,localState:null,indent:z?[]:null}},copyState:function(d){var l={state:d.state,pending:d.pending,local:d.local,localState:null,indent:d.indent&&d.indent.slice(0)};d.localState&&(l.localState=j.copyState(d.local.mode,d.localState)),d.stack&&(l.stack=d.stack.slice(0));for(var i=d.persistentStates;i;i=i.next){l.persistentStates={mode:i.mode,spec:i.spec,state:i.state==d.localState?l.localState:j.copyState(i.mode,i.state),next:l.persistentStates}}return l},token:m(v,o),innerMode:function(d){return d.local&&{mode:d.local.mode,state:d.localState}},indent:q(v,t)};if(t){for(var w in t){t.hasOwnProperty(w)&&(x[w]=t[w])}}return x}}),function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/mode/multiplex",["../../lib/codemirror"],a):a(CodeMirror)}(function(a){a.multiplexingMode=function(b){function d(i,g,k,h){if("string"==typeof g){var j=i.indexOf(g,k);return h&&j>-1?j+g.length:j}var f=g.exec(k?i.slice(k):i);return f?f.index+k+(h?f[0].length:0):-1}var c=Array.prototype.slice.call(arguments,1);return{startState:function(){return{outer:a.startState(b),innerActive:null,inner:null}},copyState:function(e){return{outer:a.copyState(b,e.outer),innerActive:e.innerActive,inner:e.innerActive&&a.copyState(e.innerActive.mode,e.inner)}},token:function(h,w){if(w.innerActive){var n=w.innerActive,k=h.string;if(!n.close&&h.sol()){return w.innerActive=w.inner=null,this.token(h,w)}var t=n.close?d(k,n.close,h.pos,n.parseDelimiters):-1;if(t==h.pos&&!n.parseDelimiters){return h.match(n.close),w.innerActive=w.inner=null,n.delimStyle&&n.delimStyle+" "+n.delimStyle+"-close"}t>-1&&(h.string=k.slice(0,t));var y=n.mode.token(h,w.inner);return t>-1&&(h.string=k),t==h.pos&&n.parseDelimiters&&(w.innerActive=w.inner=null),n.innerStyle&&(y=y?y+" "+n.innerStyle:n.innerStyle),y}for(var v=1/0,k=h.string,x=0;x<c.length;++x){var r=c[x],t=d(k,r.open,h.pos);if(t==h.pos){r.parseDelimiters||h.match(r.open),w.innerActive=r;var j=0;if(b.indent){var e=b.indent(w.outer,"","");e!==a.Pass&&(j=e)}return w.inner=a.startState(r.mode,j),r.delimStyle&&r.delimStyle+" "+r.delimStyle+"-open"}-1!=t&&t<v&&(v=t)}v!=1/0&&(h.string=k.slice(0,v));var q=b.token(h,w.outer);return v!=1/0&&(h.string=k),q},indent:function(h,f,g){var e=h.innerActive?h.innerActive.mode:b;return e.indent?e.indent(h.innerActive?h.inner:h.outer,f,g):a.Pass},blankLine:function(h){var g=h.innerActive?h.innerActive.mode:b;if(g.blankLine&&g.blankLine(h.innerActive?h.inner:h.outer),h.innerActive){"\n"===h.innerActive.close&&(h.innerActive=h.inner=null)}else{for(var e=0;e<c.length;++e){var f=c[e];"\n"===f.open&&(h.innerActive=f,h.inner=a.startState(f.mode,g.indent?g.indent(h.outer,"",""):0))}}},electricChars:b.electricChars,innerMode:function(f){return f.inner?{state:f.inner,mode:f.innerActive.mode}:{state:f.outer,mode:b}}}}}),function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror"),require("../../addon/mode/simple"),require("../../addon/mode/multiplex")):"function"==typeof define&&define.amd?define("mode/handlebars/handlebars.js",["../../lib/codemirror","../../addon/mode/simple","../../addon/mode/multiplex"],a):a(CodeMirror)}(function(a){a.defineSimpleMode("handlebars-tags",{start:[{regex:/\{\{\{/,push:"handlebars_raw",token:"tag"},{regex:/\{\{!--/,push:"dash_comment",token:"comment"},{regex:/\{\{!/,push:"comment",token:"comment"},{regex:/\{\{/,push:"handlebars",token:"tag"}],handlebars_raw:[{regex:/\}\}\}/,pop:!0,token:"tag"}],handlebars:[{regex:/\}\}/,pop:!0,token:"tag"},{regex:/"(?:[^\\"]|\\.)*"?/,token:"string"},{regex:/'(?:[^\\']|\\.)*'?/,token:"string"},{regex:/>|[#\/]([A-Za-z_]\w*)/,token:"keyword"},{regex:/(?:else|this)\b/,token:"keyword"},{regex:/\d+/i,token:"number"},{regex:/=|~|@|true|false/,token:"atom"},{regex:/(?:\.\.\/)*(?:[A-Za-z_][\w\.]*)+/,token:"variable-2"}],dash_comment:[{regex:/--\}\}/,pop:!0,token:"comment"},{regex:/./,token:"comment"}],comment:[{regex:/\}\}/,pop:!0,token:"comment"},{regex:/./,token:"comment"}],meta:{blockCommentStart:"{{--",blockCommentEnd:"--}}"}}),a.defineMode("handlebars",function(b,d){var c=a.getMode(b,"handlebars-tags");return d&&d.base?a.multiplexingMode(a.getMode(b,d.base),{open:"{{",close:/\}\}\}?/,mode:c,parseDelimiters:!0}):c}),a.defineMIME("text/x-handlebars-template","handlebars")}),function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("mode/xml/xml.js",["../../lib/codemirror"],a):a(CodeMirror)}(function(b){var a={autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0},c={autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,allowMissingTagName:!1,caseFold:!1};b.defineMode("xml",function(G,J){function X(g,d){function i(k){return d.tokenize=k,k(g,d)}var f=g.next();if("<"==f){return g.eat("!")?g.eat("[")?g.match("CDATA[")?i(U("atom","]]>")):null:g.match("--")?i(U("comment","--\x3e")):g.match("DOCTYPE",!0,!0)?(g.eatWhile(/[\w\._\-]/),i(E(1))):null:g.eat("?")?(g.eatWhile(/[\w\._\-]/),d.tokenize=U("meta","?>"),"meta"):(F=g.eat("/")?"closeTag":"openTag",d.tokenize=O,"tag bracket")}if("&"==f){var h;return h=g.eat("#")?g.eat("x")?g.eatWhile(/[a-fA-F\d]/)&&g.eat(";"):g.eatWhile(/[\d]/)&&g.eat(";"):g.eatWhile(/[\w\.\-:]/)&&g.eat(";"),h?"atom":"error"}return g.eatWhile(/[^&<]/),null}function O(g,d){var h=g.next();if(">"==h||"/"==h&&g.eat(">")){return d.tokenize=X,F=">"==h?"endTag":"selfcloseTag","tag bracket"}if("="==h){return F="equals",null}if("<"==h){d.tokenize=X,d.state=K,d.tagName=d.tagStart=null;var f=d.tokenize(g,d);return f?f+" tag error":"tag error"}return/[\'\"]/.test(h)?(d.tokenize=L(h),d.stringStartCol=g.column(),d.tokenize(g,d)):(g.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/),"word")}function L(f){var d=function(g,h){for(;!g.eol();){if(g.next()==f){h.tokenize=O;break}}return"string"};return d.isInAttribute=!0,d}function U(f,d){return function(h,g){for(;!h.eol();){if(h.match(d)){g.tokenize=X;break}h.next()}return f}}function E(d){return function(f,h){for(var g;null!=(g=f.next());){if("<"==g){return h.tokenize=E(d+1),h.tokenize(f,h)}if(">"==g){if(1==d){h.tokenize=X;break}return h.tokenize=E(d-1),h.tokenize(f,h)}}return"meta"}}function V(f,d,g){this.prev=f.context,this.tagName=d||"",this.indent=f.indented,this.startOfLine=g,(z.doNotIndent.hasOwnProperty(d)||f.context&&f.context.noIndent)&&(this.noIndent=!0)}function D(d){d.context&&(d.context=d.context.prev)}function R(f,d){for(var g;;){if(!f.context){return}if(g=f.context.tagName,!z.contextGrabbers.hasOwnProperty(g)||!z.contextGrabbers[g].hasOwnProperty(d)){return}D(f)}}function K(f,d,g){return"openTag"==f?(g.tagStart=d.column(),I):"closeTag"==f?Q:K}function I(f,d,g){return"word"==f?(g.tagName=d.current(),e="tag",B):z.allowMissingTagName&&"endTag"==f?(e="tag bracket",B(f,d,g)):(e="error",I)}function Q(g,d,h){if("word"==g){var f=d.current();return h.context&&h.context.tagName!=f&&z.implicitlyClosed.hasOwnProperty(h.context.tagName)&&D(h),h.context&&h.context.tagName==f||!1===z.matchClosing?(e="tag",P):(e="tag error",t)}return z.allowMissingTagName&&"endTag"==g?(e="tag bracket",P(g,d,h)):(e="error",t)}function P(f,d,g){return"endTag"!=f?(e="error",P):(D(g),K)}function t(f,d,g){return e="error",P(f,d,g)}function B(g,d,i){if("word"==g){return e="attribute",N}if("endTag"==g||"selfcloseTag"==g){var f=i.tagName,h=i.tagStart;return i.tagName=i.tagStart=null,"selfcloseTag"==g||z.autoSelfClosers.hasOwnProperty(f)?R(i,f):(R(i,f),i.context=new V(i,f,h==i.indented)),K}return e="error",B}function N(f,d,g){return"equals"==f?W:(z.allowMissing||(e="error"),B(f,d,g))}function W(f,d,g){return"string"==f?q:"word"==f&&z.allowUnquoted?(e="string",B):(e="error",B(f,d,g))}function q(f,d,g){return"string"==f?q:B(f,d,g)}var j=G.indentUnit,z={},n=J.htmlMode?a:c;for(var H in n){z[H]=n[H]}for(var H in J){z[H]=J[H]}var F,e;return X.isInText=!0,{startState:function(f){var d={tokenize:X,state:K,indented:f||0,tagName:null,tagStart:null,context:null};return null!=f&&(d.baseIndent=f),d},token:function(f,d){if(!d.tagName&&f.sol()&&(d.indented=f.indentation()),f.eatSpace()){return null}F=null;var g=d.tokenize(f,d);return(g||F)&&"comment"!=g&&(e=null,d.state=d.state(F||g,f,d),e&&(g="error"==e?g+" error":e)),g},indent:function(g,m,h){var k=g.context;if(g.tokenize.isInAttribute){return g.tagStart==g.indented?g.stringStartCol+1:g.indented+j}if(k&&k.noIndent){return b.Pass}if(g.tokenize!=O&&g.tokenize!=X){return h?h.match(/^(\s*)/)[0].length:0}if(g.tagName){return !1!==z.multilineTagIndentPastTag?g.tagStart+g.tagName.length+2:g.tagStart+j*(z.multilineTagIndentFactor||1)}if(z.alignCDATA&&/<!\[CDATA\[/.test(m)){return 0}var f=m&&/^<(\/)?([\w_:\.-]*)/.exec(m);if(f&&f[1]){for(;k;){if(k.tagName==f[2]){k=k.prev;break}if(!z.implicitlyClosed.hasOwnProperty(k.tagName)){break}k=k.prev}}else{if(f){for(;k;){var i=z.contextGrabbers[k.tagName];if(!i||!i.hasOwnProperty(f[2])){break}k=k.prev}}}for(;k&&k.prev&&!k.startOfLine;){k=k.prev}return k?k.indent+j:g.baseIndent||0},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"\x3c!--",blockCommentEnd:"--\x3e",configuration:z.htmlMode?"html":"xml",helperType:z.htmlMode?"html":"xml",skipAttribute:function(d){d.state==W&&(d.state=B)},xmlCurrentTag:function(d){return d.tagName?{name:d.tagName,close:"closeTag"==d.type}:null},xmlCurrentContext:function(f){for(var d=[],g=f.context;g;g=g.prev){d.push(g.tagName)}return d.reverse()}}}),b.defineMIME("text/xml","xml"),b.defineMIME("application/xml","xml"),b.mimeModes.hasOwnProperty("text/html")||b.defineMIME("text/html",{name:"xml",htmlMode:!0})}),function(a){"function"==typeof a.define&&a.define("modeHandlebars",["mode/handlebars/handlebars.js"],function(){})}(this);