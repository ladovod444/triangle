CodeMirror.defineMode("bbcode",function(h){var l,i,j;l={bbCodeTags:"b i u s img quote code list table  tr td size color url",bbCodeUnaryTags:"* :-) hr cut"};if(h.hasOwnProperty("bbCodeTags")){l.bbCodeTags=h.bbCodeTags}if(h.hasOwnProperty("bbCodeUnaryTags")){l.bbCodeUnaryTags=h.bbCodeUnaryTags}var k={cont:function(a,b){j=b;return a},escapeRegEx:function(a){return a.replace(/([\:\-\)\(\*\+\?\[\]])/g,"\\$1")}};var m={validIdentifier:/[a-zA-Z0-9_]/,stringChar:/['"]/,tags:new RegExp("(?:"+k.escapeRegEx(l.bbCodeTags).split(" ").join("|")+")"),unaryTags:new RegExp("(?:"+k.escapeRegEx(l.bbCodeUnaryTags).split(" ").join("|")+")")};var n={tokenizer:function(a,b){if(a.eatSpace()){return null}if(a.match("[",true)){b.tokenize=n.bbcode;return k.cont("tag","startTag")}a.next();return null},inAttribute:function(a){return function(c,e){var b=null;var d=null;while(!c.eol()){d=c.peek();if(c.next()==a&&b!=="\\"){e.tokenize=n.bbcode;break}b=d}return"string"}},bbcode:function(b,d){if(i=b.match("]",true)){d.tokenize=n.tokenizer;return k.cont("tag",null)}if(b.match("[",true)){return k.cont("tag","startTag")}var e=b.next();if(m.stringChar.test(e)){d.tokenize=n.inAttribute(e);return k.cont("string","string")}else{if(/\d/.test(e)){b.eatWhile(/\d/);return k.cont("number","number")}else{if(d.last=="whitespace"){b.eatWhile(m.validIdentifier);return k.cont("attribute","modifier")}if(d.last=="property"){b.eatWhile(m.validIdentifier);return k.cont("property",null)}else{if(/\s/.test(e)){j="whitespace";return null}}var c="";if(e!="/"){c+=e}var a=null;while(a=b.eat(m.validIdentifier)){c+=a}if(m.unaryTags.test(c)){return k.cont("atom","atom")}if(m.tags.test(c)){return k.cont("keyword","keyword")}if(/\s/.test(e)){return null}return k.cont("tag","tag")}}}};return{startState:function(){return{tokenize:n.tokenizer,mode:"bbcode",last:null}},token:function(a,b){var c=b.tokenize(a,b);b.last=j;return c},electricChars:""}});CodeMirror.defineMIME("text/x-bbcode","bbcode");