"use strict";(function(){var a=!CKEDITOR.env.ie||CKEDITOR.env.version>8;CKEDITOR.plugins.add("codesnippet",{requires:"widget,dialog",lang:"ar,az,bg,ca,cs,da,de,de-ch,el,en,en-au,en-gb,eo,es,es-mx,et,eu,fa,fi,fr,fr-ca,gl,he,hr,hu,id,it,ja,km,ko,ku,lt,lv,nb,nl,no,oc,pl,pt,pt-br,ro,ru,sk,sl,sq,sv,th,tr,tt,ug,uk,vi,zh,zh-cn",icons:"codesnippet",hidpi:true,beforeInit:function(d){d._.codesnippet={};this.setHighlighter=function(e){d._.codesnippet.highlighter=e;var f=d._.codesnippet.langs=d.config.codeSnippet_languages||e.languages;d._.codesnippet.langsRegex=new RegExp("(?:^|\\s)language-("+CKEDITOR.tools.objectKeys(f).join("|")+")(?:\\s|$)")}},onLoad:function(){CKEDITOR.dialog.add("codeSnippet",this.path+"dialogs/codesnippet.js")},init:function(d){d.ui.addButton&&d.ui.addButton("CodeSnippet",{label:d.lang.codesnippet.button,command:"codeSnippet",toolbar:"insert,10"})},afterInit:function(d){var f=this.path;c(d);if(!d._.codesnippet.highlighter){var e=new CKEDITOR.plugins.codesnippet.highlighter({languages:{apache:"Apache",bash:"Bash",coffeescript:"CoffeeScript",cpp:"C++",cs:"C#",css:"CSS",diff:"Diff",html:"HTML",http:"HTTP",ini:"INI",isbl:"ISBL",java:"Java",javascript:"JavaScript",json:"JSON",makefile:"Makefile",markdown:"Markdown",nginx:"Nginx",objectivec:"Objective-C",perl:"Perl",php:"PHP",python:"Python",ruby:"Ruby",sql:"SQL",vbscript:"VBScript",xhtml:"XHTML",xml:"XML"},init:function(h){var g=this;if(a){CKEDITOR.scriptLoader.load(f+"lib/highlight/highlight.pack.js",function(){g.hljs=window.hljs;h()})}if(d.addContentsCss){d.addContentsCss(f+"lib/highlight/styles/"+d.config.codeSnippet_theme+".css")}},highlighter:function(h,j,i){var g=this.hljs.highlightAuto(h,this.hljs.getLanguage(j)?[j]:undefined);if(g){i(g.value)}}});this.setHighlighter(e)}}});CKEDITOR.plugins.codesnippet={highlighter:b};function b(d){CKEDITOR.tools.extend(this,d);this.queue=[];if(this.init){this.init(CKEDITOR.tools.bind(function(){var e;while((e=this.queue.pop())){e.call(this)}this.ready=true},this))}else{this.ready=true}}b.prototype.highlight=function(){var d=arguments;if(this.ready){this.highlighter.apply(this,d)}else{this.queue.push(function(){this.highlighter.apply(this,d)})}};function c(f){var j=f.config.codeSnippet_codeClass,g=/\r?\n/g,d=new CKEDITOR.dom.element("textarea"),h=f.lang.codesnippet;f.widgets.add("codeSnippet",{allowedContent:"pre; code(language-*)",requiredContent:"pre",styleableElements:"pre",template:'<pre><code class="'+j+'"></code></pre>',dialog:"codeSnippet",pathName:h.pathName,mask:true,parts:{pre:"pre",code:"code"},highlight:function(){var k=this,m=this.data,l=function(n){k.parts.code.setHtml(a?n:n.replace(g,"<br>"))};l(CKEDITOR.tools.htmlEncode(m.code));f._.codesnippet.highlighter.highlight(m.code,m.lang,function(n){f.fire("lockSnapshot");l(n);f.fire("unlockSnapshot")})},data:function(){var k=this.data,l=this.oldData;if(k.code){this.parts.code.setHtml(CKEDITOR.tools.htmlEncode(k.code))}if(l&&k.lang!=l.lang){this.parts.code.removeClass("language-"+l.lang)}if(k.lang){this.parts.code.addClass("language-"+k.lang);this.highlight()}this.oldData=CKEDITOR.tools.copy(k)},upcast:function(l,n){if(l.name!="pre"){return}var o=e(l),m;if(o.length!=1||(m=o[0]).name!="code"){return}if(m.children.length!=1||m.children[0].type!=CKEDITOR.NODE_TEXT){return}var k=f._.codesnippet.langsRegex.exec(m.attributes["class"]);if(k){n.lang=k[1]}d.setHtml(m.getHtml());n.code=d.getValue();m.addClass(j);return l},downcast:function(k){var l=k.getFirst("code");l.children.length=0;l.removeClass(j);l.add(new CKEDITOR.htmlParser.text(CKEDITOR.tools.htmlEncode(this.data.code)));return k}});var i=/^[\s\n\r]*$/;function e(k){var m=[],l=k.children,o;for(var n=l.length-1;n>=0;n--){o=l[n];if(o.type!=CKEDITOR.NODE_TEXT||!o.value.match(i)){m.push(o)}}return m}}})();CKEDITOR.config.codeSnippet_codeClass="hljs";CKEDITOR.config.codeSnippet_theme="isbl-editor-light";