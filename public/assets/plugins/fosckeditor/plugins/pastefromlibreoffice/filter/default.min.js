(function(){function i(e,m){if(!(e.previous&&o(e.previous)&&e.getFirst().children.length&&1===e.children.length&&o(e.getFirst().getFirst()))){return !1}for(var l=f(e.previous),g=0,k=l,h=a();k=k.getAscendant(h);){g++}return(g=d(e,g))?(l.add(g),g.filterChildren(m),!0):!1}function f(e){var g=e.children[e.children.length-1];return o(g)||"li"===g.name?f(g):e}function a(){var e=!1;return function(g){return e?!1:o(g)||"li"===g.name?o(g):(e=!0,!1)}}function d(e,g){return g?d(e.getFirst().getFirst(),--g):e}function o(e){return"ol"===e.name||"ul"===e.name}function j(){return !1}var c=CKEDITOR.plugins.pastetools,b=c.filters.common,r=b.styles;CKEDITOR.plugins.pastetools.filters.libreoffice={rules:function(e,h,g){return{root:function(k){k.filterChildren(g)},comment:function(){return !1},elementNames:[[/^head$/i,""],[/^meta$/i,""],[/^strike$/i,"s"]],elements:{"!doctype":function(k){k.replaceWithChildren()},span:function(k){k.attributes.style&&(k.attributes.style=r.normalizedStyles(k,h),r.createStyleStack(k,g,h));CKEDITOR.tools.object.entries(k.attributes).length||k.replaceWithChildren()},p:function(l){var m=CKEDITOR.tools.parseCssText(l.attributes.style);if(h.plugins.pagebreak&&("always"===m["page-break-before"]||"page"===m["break-before"])){var k=CKEDITOR.plugins.pagebreak.createElement(h),k=CKEDITOR.htmlParser.fragment.fromHtml(k.getOuterHtml()).children[0];k.insertBefore(l)}l.attributes.style=CKEDITOR.tools.writeCssText(m);l.filterChildren(g);r.createStyleStack(l,g,h)},div:function(k){r.createStyleStack(k,g,h)},a:function(k){if(k.attributes.style){var l=k.attributes;k=CKEDITOR.tools.parseCssText(k.attributes.style);"#000080"===k.color&&delete k.color;"underline"===k["text-decoration"]&&delete k["text-decoration"];k=CKEDITOR.tools.writeCssText(k);l.style=k}},h1:function(k){r.createStyleStack(k,g,h)},h2:function(k){r.createStyleStack(k,g,h)},h3:function(k){r.createStyleStack(k,g,h)},h4:function(k){r.createStyleStack(k,g,h)},h5:function(k){r.createStyleStack(k,g,h)},h6:function(k){r.createStyleStack(k,g,h)},pre:function(k){r.createStyleStack(k,g,h)},font:function(l){var m;m="a"===l.parent.name&&"#000080"===l.attributes.color?!0:1!==l.parent.children.length||"sup"!==l.parent.name&&"sub"!==l.parent.name||"2"!==l.attributes.size?!1:!0;m&&l.replaceWithChildren();m=CKEDITOR.tools.parseCssText(l.attributes.style);var k=l.getFirst();l.attributes.size&&k&&k.type===CKEDITOR.NODE_ELEMENT&&/font-size/.test(k.attributes.style)&&l.replaceWithChildren();m["font-size"]&&(delete l.attributes.size,l.name="span",k&&k.type===CKEDITOR.NODE_ELEMENT&&k.attributes.size&&k.replaceWithChildren())},ul:function(k){if(i(k,g)){return !1}},ol:function(k){if(i(k,g)){return !1}},img:function(k){if(!k.attributes.src){return !1}},table:function(l){var m=l.attributes;l=l.attributes.style;var k=CKEDITOR.tools.parseCssText(l);k["border-collapse"]||(k["border-collapse"]="collapse",l=CKEDITOR.tools.writeCssText(k));m.style=l}},attributes:{style:function(l,k){return r.normalizedStyles(k,h)||!1},align:function(l,k){if("img"!==k.name){var m=CKEDITOR.tools.parseCssText(k.attributes.style);m["text-align"]=k.attributes.align;k.attributes.style=CKEDITOR.tools.writeCssText(m);return !1}},cellspacing:j,cellpadding:j,border:j}}}};CKEDITOR.pasteFilters.libreoffice=c.createFilter({rules:[b.rules,CKEDITOR.plugins.pastetools.filters.libreoffice.rules]})})();